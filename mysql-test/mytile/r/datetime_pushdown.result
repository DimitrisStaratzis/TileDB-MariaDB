#
# The purpose of this test is to validate MyTile pushdown of datetime conditions
#
CREATE TABLE dt (
column1 datetime(6) dimension=1 tile_extent="10",
column2 BLOB
) ENGINE=mytile;
INSERT INTO dt VALUES ('2020-10-20 00:00:00.000000','aHR0cHM6Ly9naXRodWIuY29tL1NoZWxudXR0Mi9jcnVuY2g=');
INSERT INTO dt VALUES ('2020-10-20 01:00:00.000000','dmFsdWUy');
INSERT INTO dt VALUES ('2020-10-20 02:00:00.000000','dmFsdWU');
SELECT * from dt;
column1	column2
2020-10-20 00:00:00.000000	aHR0cHM6Ly9naXRodWIuY29tL1NoZWxudXR0Mi9jcnVuY2g=
2020-10-20 01:00:00.000000	dmFsdWUy
2020-10-20 02:00:00.000000	dmFsdWU
EXPLAIN SELECT column1, column2 FROM dt WHERE column1 = '2020-10-20 02:00:00.000000';
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	dt	ALL	NULL	NULL	NULL	NULL	2	Using where with pushed condition
SELECT column1, column2 FROM dt WHERE column1 = '2020-10-20 02:00:00.000000';
column1	column2
2020-10-20 02:00:00.000000	dmFsdWU
EXPLAIN SELECT column2 FROM dt WHERE column1 IN ('2020-10-20 00:00:00.000000','2020-10-20 02:00:00.000000') ORDER BY column1 asc;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	dt	ALL	NULL	NULL	NULL	NULL	2	Using where with pushed condition; Using temporary; Using filesort
SELECT column2 FROM dt WHERE column1 IN ('2020-10-20 00:00:00.000000','2020-10-20 02:00:00.000000') ORDER BY column1 asc;
column2
aHR0cHM6Ly9naXRodWIuY29tL1NoZWxudXR0Mi9jcnVuY2g=
dmFsdWU
SELECT * FROM dt WHERE column2 = 'dmFsdWU';
column1	column2
2020-10-20 02:00:00.000000	dmFsdWU
DROP TABLE dt;
